<!-- produto.component.html -->
<div class="new-produto-form">
  <h2>Atualizar Produto</h2>
  <form #produtoForm="ngForm">
    <div class="form-field">
      <label for="nome">Nome:</label>
      <input type="text" id="nome" name="nome" [(ngModel)]="produto!.nome!" required>
    </div>

    <div class="form-field">
      <label for="nomeLongo">Nome longo:</label>
      <input type="text" id="nomeLongo" name="nomeLongo" [(ngModel)]="produto!.nomeLongo!" required>
    </div>

    <div class="form-field">
      <label for="descricao">Descricao:</label>
      <input type="text" id="descricao" name="descricao" [(ngModel)]="produto!.descricao!" required>
    </div>

    <div class="form-field">
      <label for="valorCompra">Custo:</label>
      <input type="number" id="valorCompra" name="valorCompra" [(ngModel)]="produto!.valorCompra!" required>
    </div>

    <div class="form-field">
      <label for="preco">Pre√ßo:</label>
      <input type="number" id="preco" name="preco" [(ngModel)]="produto!.preco!" required>
    </div>

    <div class="form-field">
      <label for="estoque">Estoque:</label>
      <input type="number" id="estoque" name="estoque" [(ngModel)]="produto!.estoque!" required>
    </div>

    <div>
      <mat-form-field style="width: 100%;">
        <mat-label>Categorias</mat-label>
        <mat-select type="number[]" id="categoriasId" name="categoriasId" [(ngModel)]="produto!.categoriasId!" multiple>
          @for (categoria of categorias; track categoria.id) {

          <mat-option [value]="categoria.id">{{categoria.nome}}</mat-option>
          }
        </mat-select>
      </mat-form-field>
    </div>

    <div>
      <mat-form-field style="width: 100%;">
        <mat-label>Marca</mat-label>
        <mat-select type="number" id="idMarca" name="idMarca" [(ngModel)]="produto!.idMarca!">
          @for (marca of marcas; track marca.id) {

          <mat-option [value]="marca.id">{{marca.nome}}</mat-option>
          }
        </mat-select>
      </mat-form-field>
    </div>

    @for (imagem of img; track imagem) {
    <div class="image-list">
      <div class="image-item">
        <!-- <img src="http://localhost:8080/file/download/{{imagem}}" alt="Image {{imagem}}" class="product-image" />  <!-- producao -->
        <img src="{{imagem}}" alt="Image {{imagem}}" class="product-image" /> <!-- desenvolvimento -->
        <button mat-flat-button color="warn" (click)="removeImage(imagem)">Remover</button>
      </div>
    </div>
    }

    <div class="add-image">
      <p class="instruction">Por favor, adicione uma imagem de cada vez.</p>
      <input type="file" (change)="uploadFile($event)" />
    </div>

    <div *ngIf="uploadPercent !== undefined" class="upload-progress">
      <mat-progress-bar mode="determinate" [value]="uploadPercent"></mat-progress-bar>
      <div class="upload-percent">
        Upload: {{ uploadPercent}}%
      </div>
    </div>




    <div class="button-container">
      <button mat-flat-button color="warn" (click)="cancelar()">Cancelar</button>
      <button mat-flat-button color="primary" type="submit" (click)="atualizarProduto()">Atualizar</button>
    </div>
  </form>
</div>
